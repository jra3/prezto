# Local variables:
# coding: utf-8
# mode: sh
# End:

# Source Prezto.
if [[ -s "${ZDOTDIR:-$HOME}/.zprezto/init.zsh" ]]; then
  source "${ZDOTDIR:-$HOME}/.zprezto/init.zsh"
fi

# define LOCAL_ADMIN_SCRIPTS in /etc/zshenv
local master_file="${LOCAL_ADMIN_SCRIPTS}/master.zshrc"
if [ -f "$master_file" ]; then
  source "$master_file"
fi

export EMACS_PLUGIN_LAUNCHER="${ZDOTDIR:-$HOME}/.zprezto/modules/emacs/emacsclient.sh"
alias emacs="$EMACS_PLUGIN_LAUNCHER"
alias e=emacs

alias eeval="$EMACS_PLUGIN_LAUNCHER --eval"
alias eframe='emacsclient --alternate-editor "" --create-frame'

# Write to standard output the directory of the file
# opened in the the current buffer
function ecd {
    local cmd="(let ((buf-name (buffer-file-name (window-buffer))))
                     (if buf-name (file-name-directory buf-name)))"

    local dir="$($EMACS_PLUGIN_LAUNCHER --eval $cmd | tr -d \")"
    if [ -n "$dir" ] ;then
        echo "$dir"
    else
        echo "can not deduce current buffer filename." >/dev/stderr
        return 1
    fi
}

function efile {
    local cmd="(buffer-file-name (window-buffer))"
    "$EMACS_PLUGIN_LAUNCHER" --eval "$cmd" | tr -d \"
}

export GOROOT=/usr/local/opt/go/libexec
export GOPATH=$HOME/go
export PATH=~/bin:$PATH:$GOPATH/bin:$GOROOT/bin

export EMACS_DIR=~/.dot-emacs
export INPUTRC=~/.inputrc

EDITOR="~/bin/e"
VISUAL=$EDITOR

alias g=git

local fb_prompt_file="${LOCAL_ADMIN_SCRIPTS}/scm-prompt"
if [ -f "$fb_prompt_file" ]; then
  source "$fb_prompt_file"
else
  echo "couldn't find FB SCM prompt file ${fb_prompt_file}"
fi
